
<!--
  A-Z list with alpha jumps version 1
  2/20/17
  ====================================
    - Going to try a version of the A-Z alpha filter using HTML/empty divs instead of jquery
    - Right now, this doesn't work, but there is a working older version on the live site
-->

<script src="https://cdn.jsdelivr.net/lodash/4.17.4/lodash.min.js"></script><!-- load lodash for filtering API list -->
<style type="text/css">
select {
   height:100%;
}
</style>

<div class="dropdown"> <!-- Database by Type filter dropdown -->
 <select class="az-type">
   
    <option>Database by Type</option>
    <option class="type" value="eBook Collections">eBook Collections</option>
    <option class="type" value="Reference Sources">Reference Sources</option>
    <option class="type" value="News Sources">News Sources</option>
    <option class="type" value="Streaming Video Collections">Streaming Video Collections</option>
    
  </select>

</div>

<div class="dropdown"> <!-- Database by Subject filter dropdown -->
  <select class="az-subject">
    <option>Database by Subject</option>
    <option class="subject" value="Business">Business</option>
    <option class="subject" value="Applied Sciences & Engineering">Applied Sciences & Engineering</option>
    <option class="subject" value="Technology">Technology</option>
    <option class="subject" value="Fine Arts & Design">Fine Arts & Design</option>
    <option class="subject" value="Health Sciences & Nursing">Health Sciences & Nursing</option>
    <option class="subject" value="Public & Social Science">Public & Social Science</option>
    <option class="subject" value="Liberal Arts & Sciences">Liberal Arts & Sciences</option>
    <option class="subject" value="Education">Education</option>
    
  </select>
</div>

<div id="first-letters"> <!-- alphabet filter links -->
  <a href="#letter_A" id="first-letter-A">A</a> <a href="#letter_B" id="first-letter-B">B</a> <a href="#letter_C" id="first-letter-C">C</a> <a href="#letter_D" id="first-letter-D">D</a> <a href="#letter_E" id="first-letter-E">E</a> <a href="#letter_F" id="first-letter-F">F</a> <a href="#letter_G" id="first-letter-G">G</a> <a href="#letter_H" id="first-letter-H">H</a> <a href="#letter_I" id="first-letter-I">I</a> <a href="#letter_J" id="first-letter-J">J</a> <a href="#letter_L" id="first-letter-L">L</a> <a href="#letter_M" id="first-letter-M">M</a> <a href="#letter_N" id="first-letter-N">N</a> <a href="#letter_O" id="first-letter-O">O</a> <a href="#letter_P" id="first-letter-P">P</a> <a href="#letter_R" id="first-letter-R">R</a> <a href="#letter_S" id="first-letter-S">S</a> <a href="#letter_T" id="first-letter-T">T</a> <a href="#letter_U" id="first-letter-U">U</a> <a href="#letter_V" id="first-letter-V">V</a> <a href="#letter_W" id="first-letter-W">W</a>
</div>

<div id="AZ-list"></div> <!-- div where the A-Z list ends up -->



<script>
 
 
 /*
 Unedited from a-z_v3-type-subject.html as of 2/20/17
 */
 
 $(document).ready(function (){
   
   //all central indiana region databases
   
     var azAPI = "https://lgapi-us.libapps.com/1.1/assets?site_id=103&key=83d416dc1ba38e91c12fee5de29a4527&asset_types=10&expand=az_types,subjects";

  function displayAZlist(data) {
 
 //returns an array that holds all databases listed as Central Indiana as objects
 var CIdatabases = _.filter(response.responseJSON, (['az_types[0].name', 'Central Indiana Region']));
	
	//sorts alphabetically
var sorted = _.sortBy(CIdatabases, 'name');
 
 //and places each database in list
 var listHTML = '<ul>';
 
     
   _.forEach(sorted, function(database) {
     
            listHTML += '<li>';
            listHTML += '<a href="' + database.url + '" target="_blank">';
            listHTML += database.name;
            listHTML += '</a><br/>';
            listHTML += '<div class="az-description"><p>'
            listHTML += database.description;
            listHTML += '</p></div>'
            listHTML += '</li>'
  });

listHTML += '</ul>';

//then appends list to #AZ-list div
$('#AZ-list').append(listHTML);

  }
  
var response = $.getJSON(azAPI, displayAZlist);
   
//========== filtering by type/subject stuff ==========================================================

var CIdatabases;

   //on click
   $('select').change(function(){
     //remove 'selected' class
    $('select option:selected').removeClass('selected');
    //add selected class to actually clicked button
    $('select option:selected').addClass('selected');
    
    
     
    
     //grab text from button
   var buttonText = $('option:selected',this).attr('value');
   //trim it down so it's a nice and neat variable
	  buttonText = $.trim(buttonText);
	  //set buttonClass='type' to true
	  var buttonClass = $('option:selected',this).hasClass('type');

      var azAPI = "https://lgapi-us.libapps.com/1.1/assets?site_id=103&key=83d416dc1ba38e91c12fee5de29a4527&asset_types=10&expand=az_types,subjects";
   

  function displayAZlist(data) {
 
        //if buttonClass === true (i.e. class is type)
  
        if ( buttonClass ) {
        //returns an array that holds all databases listed as Central Indiana as objects that are also that type of database clicked
        var CIdatabases = _.filter(response.responseJSON, {az_types: [{name: 'Central Indiana Region'}] && [{name: buttonText}] });
        } else {
          //returns an array that holds all databases listed as Central Indiana as objects that are also that type of database clicked
        var CIdatabases = _.filter(response.responseJSON, {az_types: [{name: 'Central Indiana Region'}] } && {subjects: [{name: buttonText}] });
        }
        	//sorted alphabetically
        var sorted = _.sortBy(CIdatabases, 'name');
         //and placed in a list
        var listHTML = '<ul>';
         
             
          _.forEach(sorted, function(database) {
             
              listHTML += '<li>';
              listHTML += '<a href="' + database.url + '" target="_blank">';
              listHTML += database.name;
              listHTML += '</a><br/>';
              listHTML += '<div class="az-description"><p>'
              listHTML += database.description;
              listHTML += '</p></div>'
              listHTML += '</li>'
              
          });
        
        listHTML += '</ul>';
        
        //empty old AZ list and replace with new list
        $('#AZ-list').empty();
        $('#AZ-list').append(listHTML);
        
          }
          
        var response = $.getJSON(azAPI, displayAZlist);
     
  });
   
 });
</script>
